{"version":3,"sources":["simpleui/MyCard.tsx","SportsDataAccessors/NFLHelper.ts","components/GameTable.tsx","components/NFL.tsx","hooks/useVisibilityHandlers.ts","App.tsx","index.tsx"],"names":["MyCard","CardHeader","_ref","title","children","react_default","a","createElement","Card","CardBody","convertToTypes","unTypedData","schedule","displayDate","concat","w","games","gms","map","g","status","awayTeam","homeTeam","qtr","playing","clock","extrainfo","gameSchedule","gameDate","t","visitorNickname","away","abbr","homeNickname","home","push","id","eid","awayTeamWinning","visitor_winning","homeTeamWinning","home_winning","awayTeamScore","score","T","homeTeamScore","awayTeamHasPosession","visitor_pos","homeTeamHasPosession","home_pos","hidden","carryOverHiddenGames","cachedSchedule","i","cachedGame","filter","cg","fetchNFLDataAsync","_x","_fetchNFLDataAsync","apply","this","arguments","_callee","typedData","typedDataWithHiddens","regenerator_default","wrap","_context","prev","next","fetch","sent","json","abrupt","stop","GameRow","game","removeGame","react","className","Button","outline","color","size","onClick","TableHeader","GameTable","_ref2","Table","responsive","GameTable_TableHeader","index","GameTable_GameRow","key","NFL","_useState","useState","_useState2","Object","slicedToArray","setSchedule","_useState3","_useState4","isLoading","setIsLoading","upDateSchedule","asyncToGenerator","mark","cachedScheduleString","_schedule","console","log","localStorage","getItem","JSON","parse","ReactDOM","unstable_batchedUpdates","setItem","stringify","t0","useEffect","onVisibleCallback","pageVisible","inFocus","outFocus","handleVisibilityChange","document","window","addEventListener","removeEventListener","useVisibilityHandlers","simpleui_MyCard","removeItem","disabled","style","width","Spinner","type","Progress","animated","height","value","components_GameTable","newGames","App","render","src_App","getElementById"],"mappings":"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","file":"static/js/main.4203aebc.chunk.js","sourcesContent":["import React, { ReactNode } from 'react';\nimport { Card, CardBody, CardHeader } from 'reactstrap';\n\nconst MyCard:React.FC<{ title: ReactNode }> = ({ title, children}) => {\n  return (\n    <Card>\n      <CardHeader>{title}</CardHeader>\n      <CardBody>{children}</CardBody>\n    </Card>\n  );\n}\n\nexport const MyCardHeader = CardHeader;\n// export const MyCardBody = CardBody;\n\nexport default MyCard;\n","import { NFLSchedule } from './types';\n\nfunction convertToTypes(unTypedData: any) {\n  const schedule:NFLSchedule = {\n    displayDate: `Week ${unTypedData.w}`,\n    games: []\n  };\n\n  unTypedData.gms.map((g:any) => {\n    let status: string;\n    if (g.qtr) {\n      if (g.playing) {\n        status = `${g.qtr}Q, ${g.clock}`;\n      } else {\n        status = g.qtr;\n      }\n    } else {\n      if (g.extrainfo) {\n        status = `${g.extrainfo.gameSchedule.gameDate} ${g.t}`;\n      } else {\n        status = g.t;\n      }\n    }\n\n    let awayTeam: string;\n    if (g.extrainfo) {\n      awayTeam = g.extrainfo.gameSchedule.visitorNickname;\n    } else {\n      awayTeam = g.away.abbr;\n    }\n\n    let homeTeam: string;\n    if (g.extrainfo) {\n      homeTeam = g.extrainfo.gameSchedule.homeNickname;\n    } else {\n      homeTeam = g.home.abbr;\n    }\n\n    schedule.games.push(\n      {\n        id: g.eid,\n        status: status,\n        awayTeam: awayTeam,\n        homeTeam: homeTeam,\n        awayTeamWinning: g.visitor_winning,\n        homeTeamWinning: g.home_winning,\n        awayTeamScore: g.away.score.T,\n        homeTeamScore: g.home.score.T,\n        awayTeamHasPosession: g.visitor_pos,\n        homeTeamHasPosession: g.home_pos,\n        hidden: false\n      }\n    );\n\n    return g;\n  });\n  return schedule;\n}\n\nfunction carryOverHiddenGames(schedule: NFLSchedule, cachedSchedule: NFLSchedule) {\n  if (schedule.displayDate !== cachedSchedule.displayDate) return schedule;\n\n  schedule.games.map((g, i) => {\n    // if (g.id !== cachedSchedule.games[i].id)\n    // g.hidden = cachedSchedule.games[i].hidden;\n\n    // shouldn't this be of type Game | undefined\n    const cachedGame = cachedSchedule.games.filter(cg => cg.id === g.id)[0];\n    if (cachedGame) g.hidden = cachedGame.hidden;\n\n    // need a better way to do this\n\n    return g;\n  });\n\n  return schedule;\n}\n\nfunction sleep(ms:number) {\n  return new Promise(resolve => setTimeout(resolve, ms));\n}\n\nexport async function fetchNFLDataAsync(cachedSchedule: NFLSchedule|undefined): Promise<NFLSchedule> {\n  const url = 'https://sports-new-tab-page.appspot.com/nfl';\n  const unTypedData = await (await fetch(url)).json();\n  const typedData = convertToTypes(unTypedData);\n\n  if (!cachedSchedule) return typedData;\n\n  const typedDataWithHiddens = carryOverHiddenGames(typedData, cachedSchedule);\n  return typedDataWithHiddens;\n}\n","import * as React from 'react';\nimport { Button, Table } from 'reactstrap';\nimport { NFLGame } from '../SportsDataAccessors/types';\n\nconst GameRow = ({ game, removeGame }: { game: NFLGame, removeGame: (id: number) => void }) => {\n  const handleClick = () => removeGame(game.id);\n\n  return (\n    <tr>\n      <td>{game.status}</td>\n\n      <td className={`${game.awayTeamWinning ? 'winning_team' : ''} ${game.awayTeamHasPosession ? 'has_posession' : ''}`}>\n        {game.awayTeam}\n        {game.awayTeamHasPosession && <span className=\"d-none d-md-inline d-lg-inline\"> üèà</span>}\n      </td>\n\n      <td className={`${game.homeTeamWinning && 'winning_team'} ${game.homeTeamHasPosession ? 'has_posession' : ''}`}>\n        {game.homeTeam}\n        {game.homeTeamHasPosession && <span className=\"d-none d-md-inline d-lg-inline\"> üèà</span>}\n      </td>\n\n      <td>{game.awayTeamScore}</td>\n      <td>{game.homeTeamScore}</td>\n\n      <td>\n        <Button outline={true} color=\"secondary\" size=\"sm\" onClick={handleClick}>&#9587;</Button>\n      </td>\n    </tr>\n  );\n}\n\nconst TableHeader = () => (\n  <thead>\n    <tr>\n      <th/>{/* status */}\n      <th>away</th>\n      <th>@home</th>\n      <th>a</th>\n      <th>h</th>\n      <th/>{/* X */}\n    </tr>\n  </thead>\n);\n\nconst GameTable = ({ games, removeGame }: { games: NFLGame[], removeGame: (id: number) => void }) => (\n  <Table responsive size=\"sm\">\n    <TableHeader />\n    <tbody>\n      {\n        games\n          .filter(game => !game.hidden)\n          .map((game, index) => <GameRow key={index} game={game} removeGame={removeGame} />)\n      }\n    </tbody>\n  </Table>\n);\n\nexport default GameTable;\n","import React, { useEffect, useState } from 'react';\nimport ReactDOM from 'react-dom';\nimport { Button, Progress, Spinner } from 'reactstrap';\nimport useVisibilityHandlers from '../hooks/useVisibilityHandlers';\nimport { Card } from '../simpleui';\nimport { fetchNFLDataAsync } from '../SportsDataAccessors/NFLHelper';\nimport { Schedule } from '../SportsDataAccessors/types';\nimport GameTable from './GameTable';\n\nexport default function NFL() {\n  const LOCAL_STORAGE_KEY = 'nfl-schedule-data';\n\n  const [schedule, setSchedule] = useState<Schedule>({\n    displayDate: '',\n    games: [],\n  });\n\n  const [isLoading, setIsLoading] = useState<boolean>(false);\n\n  const upDateSchedule = async () => {\n    let cachedSchedule: Schedule | undefined;\n\n    // TODO only look at cache when needed\n    console.log('using cache')\n    const cachedScheduleString = localStorage.getItem(LOCAL_STORAGE_KEY);\n    if (cachedScheduleString) {\n      cachedSchedule = JSON.parse(cachedScheduleString);\n    }\n    //...//\n\n    ReactDOM.unstable_batchedUpdates(() => {\n      if (cachedSchedule) setSchedule(cachedSchedule);\n      setIsLoading(true);\n    });\n\n    try {\n      const schedule = await fetchNFLDataAsync(cachedSchedule);\n      ReactDOM.unstable_batchedUpdates(() => {\n        setSchedule(schedule);\n        setIsLoading(false);\n      });\n      localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(schedule));\n    } catch {\n      setIsLoading(false);\n    }\n  }\n\n  const resetSchedule = () => {\n    localStorage.removeItem(LOCAL_STORAGE_KEY);\n    upDateSchedule();\n  }\n\n  useEffect(() => {\n    upDateSchedule();\n  }, []);\n\n  useVisibilityHandlers(upDateSchedule);\n\n  const removeGame = (id: number) => {\n    const newGames = schedule.games.map(game => {\n      if (game.id === id) {\n        game.hidden = true;\n      }\n      return game;\n    });\n\n    setSchedule({ displayDate: schedule.displayDate, games: newGames });\n    localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(schedule));\n  }\n\n  console.log('rendering...');\n  return (\n    <Card\n      title={\n        <span>\n          <span className=\"font-weight-bold\">NFL</span>\n          <span className=\"pl-2 font-weight-light font-italic text-lowercase text-muted\">{schedule.displayDate}</span>\n          <Button\n            outline\n            size=\"sm\"\n            className=\"float-right\"\n            onClick={resetSchedule}\n            disabled={isLoading}\n            style={{width:'50px'}}\n          >\n            {isLoading ? <Spinner size=\"sm\" color=\"primary\" type=\"grow\" /> : 'Reset'}\n          </Button>\n        </span>\n      }\n    >\n      {isLoading && <Progress animated style={{height: '5px'}} color=\"info\" value={100} />}\n\n      <GameTable games={schedule.games} removeGame={removeGame} />\n    </Card>\n  );\n}\n","import { useEffect } from 'react';\n\n// TODO -- write test with multiple components using independenly\nexport default function useVisibilityHandlers(onVisibleCallback: () => void) {\n  let pageVisible = true;\n\n  const inFocus = () => {\n    if (!pageVisible) { onVisibleCallback(); }\n    pageVisible = true;\n  }\n\n  const outFocus = () => pageVisible = false;\n\n  const handleVisibilityChange = () => {\n    if (document.hidden) {\n      pageVisible = false;\n    } else {\n      if (!pageVisible) { onVisibleCallback(); }\n      pageVisible = true;\n    }\n  }\n\n  useEffect(() => {\n    window.addEventListener('focus', inFocus);\n    window.addEventListener('blur', outFocus);\n    document.addEventListener('visibilitychange', handleVisibilityChange, false);\n\n    return () =>{\n      window.removeEventListener('focus', inFocus);\n      window.removeEventListener('blur', outFocus);\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\n    };\n  }, []);\n}\n","import React from 'react';\nimport './App.css';\nimport NFL from './components/NFL';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <div className=\"container-fluid\">\n        <div className=\"card-columns\">\n          <NFL />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport 'bootstrap/dist/css/bootstrap.css';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}